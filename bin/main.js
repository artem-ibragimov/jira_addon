"use strict";class e{totalTime;constructor(e,t){this.totalTime=t;const n=document.createElement("div"),r=document.createElement("div");r.innerHTML=this.getDataMarkup(),r.hidden=!0;const o=document.createElement("a");o.innerText="ðŸ“Š",o.onclick=()=>{r.hidden=!r.hidden},n.append(o,r),e.insertBefore(n,e.firstChild)}getDataMarkup(){return`<ul>${Object.entries(this.totalTime).map((([e,t])=>`<li>${e} - ${t}d</li>`)).join("")}</ul>`}}function t(e){return new Promise(((t,n)=>{const r=new XMLHttpRequest;r.onreadystatechange=()=>{r.readyState==XMLHttpRequest.DONE&&200==r.status&&t(r.responseText)},r.onabort=n,r.onerror=n,r.open("GET",`/rest/greenhopper/1.0/xboard/plan/v2/backlog/data?rapidViewId=${e}&forceConsistency=true`),r.send()}))}function n(e){const t=JSON.parse(e);return Object.fromEntries(t.issues.map((e=>[e.key,e])))}function r(t){Array.from(document.querySelectorAll(".ghx-issues")).forEach((n=>{const r={};Array.from(n.children).forEach((e=>{const n=e.querySelector("span.ghx-items-container"),o=e.getAttribute("data-issue-key");if(!n||!o)return;const a=document.createElement("span"),s=t[o].trackingStatistic.statFieldValue.text;a.innerText=s,n.insertBefore(a,n.firstChild);const i=t[o].assigneeName||"Unassigned";r[i]=Math.round(100*(r[i]||0+parseFloat(s||"0")))/100})),new e(n,r),console.info(r)}))}window.addEventListener("load",(()=>{new Promise(((e,t)=>{try{const n=localStorage.getItem("gh.latestRapidViewId");if(!n)return t(new Error("No rapidViewId"));e(n)}catch(e){t(e)}})).then(t).then(n).then(r).catch(console.error)}));
